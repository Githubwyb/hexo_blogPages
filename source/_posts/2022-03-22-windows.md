---
title: windows系统相关的总结
date: 2022-03-22 11:55:15
tags: [windows]
categories: [Program, system]
---

# 一、系统知识

# 二、windows编程

## 1. 网络编程

### 1.1. 工具函数

#### 1) 网络字节序转换

```cpp
// #include <WinSock2.h>

uint32_t ntohl (uint32_t __netlong);
uint16_t ntohs (uint16_t __netshort);
uint32_t htonl (uint32_t __hostlong);
uint16_t htons (uint16_t __hostshort);
```

## 2. 编译器

### 2.1. visual studio

#### 1) 预定义宏

https://docs.microsoft.com/zh-cn/cpp/preprocessor/predefined-macros?view=msvc-170

# 三、有用的几个技巧

## 1. 查看程序是64bit还是32bit

- 对exe右键属性
- 若降低色彩和分辨率的选项可勾选就是32位，不可勾选就是64位

# 四、好用的软件

## 1. mingw

- minimal gnu for windows
- 在windows上使用gcc

### 1.1. 安装

- 下载免安装版本[sourceForge](https://sourceforge.net/projects/mingw-w64/files/)

**posix和win32**

- posix可以将`std::thread`转发成windows的实现
- win32不允许使用`std::thread`，需要使用win32实现

**seh和sjlj**

- seh可以处理`signal()`

# 小技巧和踩坑记

## 1. 低版本windows调用系统api获取dns地址时报11003错误

- 根据排查，发现是系统api对于dns回包的兼容性不好
- dns请求在win7上请求会有A和AAAA两个记录，但是如果AAAA记录的响应返回了A的ip，就会报这个错误

## 2. windows的线程轮转时间是10ms

- 使用`std::future`的`wait_for()`方法，看似等待`3ms`，实际可能整体执行时间是`10ms`以上

## 3. IN和OUT为windows的api默认定义用来进行标识参数的方向

- 定义关键字不能使用`IN`和`OUT`，因为它们是windows的api的默认定义

```cpp
// 编译会报错，因为IN和OUT在windows下定义成了空
enum class Direction {
    IN,
    OUT,
};
```

## 4. 编译错误

### 4.1. 无法解析外部符号 `_GetAdaptersInfo@8`

- 在代码中添加下面一句即可

```cpp
#pragma comment(lib, "iphlpapi.lib")
```
