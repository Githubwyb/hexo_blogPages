---
title: C语言学习笔记
date: 2018-09-18 16:05:29
tags: [C/C++]
categories: [notes, study]
top: true
---

# 大小

```C
    //32位编译
    int main(int argC, char* arg[]) {
        LOG_DEBUG("Size of void * %d", sizeof(void *));         //4
        LOG_DEBUG("Size of char %d", sizeof(char));             //1
        LOG_DEBUG("Size of short %d", sizeof(short));           //2
        LOG_DEBUG("Size of short int %d", sizeof(short int));   //2
        LOG_DEBUG("Size of int %d", sizeof(int));               //4
        LOG_DEBUG("Size of long %d", sizeof(long));             //4
        LOG_DEBUG("Size of long int %d", sizeof(long int));     //4
        LOG_DEBUG("Size of long long %d", sizeof(long long));   //8
        return 0;
    }

    //64位编译
    int main(int argC, char* arg[]) {
        LOG_DEBUG("Size of void * %d", sizeof(void *));         //8
        LOG_DEBUG("Size of char %d", sizeof(char));             //1
        LOG_DEBUG("Size of short %d", sizeof(short));           //2
        LOG_DEBUG("Size of short int %d", sizeof(short int));   //2
        LOG_DEBUG("Size of int %d", sizeof(int));               //4
        LOG_DEBUG("Size of long %d", sizeof(long));             //8
        LOG_DEBUG("Size of long int %d", sizeof(long int));     //8
        LOG_DEBUG("Size of long long %d", sizeof(long long));   //8
        return 0;
    }
```

# 输出家族函数

```C++
    #include <stdio.h>

    int printf(const char *format, ...); //输出到标准输出
    int fprintf(FILE *stream, const char *format, ...); //输出到文件
    int sprintf(char *str, const char *format, ...); //输出到字符串str中
    int snprintf(char *str, size_t size, const char *format, ...); //按size大小输出到字符串str中
```

以下函数功能与上面的一一对应相同，只是在函数调用时，把上面的...对应的一个个变量用va_list调用所替代。在函数调用前ap要通过va_start()宏来动态获取。

```C++
    #include <stdarg.h>

    int vprintf(const char *format, va_list ap);
    int vfprintf(FILE *stream, const char *format, va_list ap);
    int vsprintf(char *str, const char *format, va_list ap);
    int vsnprintf(char *str, size_t size, const char *format, va_list ap);
```

# const的使用

```C
    const char *p;          //*p是const,p可变：const 后面紧跟的是char，所以*p是一个char字符，不可变
    const (char *) p;       // p是const,*p可变：const 后面紧跟的是（char *）这个整体，所以p是char*类型，不可变。
    char* const p;          // p是const,*p可变:const 后面紧跟的是p,所以p不可变
    const char* const p;    // p和*p都是const：第一个const后面紧跟的是char,所以char类型的字符*p不可变；第二个const后面紧跟的是p,所以p不可变。
    char const * p;         // *p是const,p可变：const后面紧跟的是*,但是单独的*不能表明修饰的内容，所以将*p看成一个整体，所以const修饰的是*p,*p不可变。
    (char*) const p;        // p是const,*p可变：const紧跟的是p,所以p不可变。
    char* const p;          // p是const,*p可变：const紧跟的是p,所以p不可变。
    char const* const p;    // p和*p都是const：第一个const紧跟的是*,不能表明修饰的内容，将后面整体的（* const p）看成一个整体，那就说明*p不可变，第二个const后面紧跟的是p,所以p不可变。
```

# exit和return

- exit用于在程序运行的过程中随时结束程序，exit的参数是返回给OS的。main函数结束时也会隐式地调用exit函数。exit函数运行时首先会执行由atexit()函数登记的函数，然后会做一些自身的清理工作，同时刷新所有输出流、关闭所有打开的流并且关闭通过标准I/O函数tmpfile()创建的临时文件。exit是结束一个进程，它将删除进程使用的内存空间，同时把错误信息返回父进程；而return是返回函数值并退出函数。通常情况：exit(0)表示程序正常, exit(1)和exit(-1)表示程序异常退出，exit(2)表示表示系统找不到指定的文件。在整个程序中，只要调用exit就结束（当前进程或者在main时候为整个程序）。
- return是语言级别的，它表示了调用堆栈的返回；return( )是当前函数返回，当然如果是在主函数main, 自然也就结束当前了，如果不是，那就是退回上一层调用。在多个进程时。如果有时要检测上个进程是否正常退出。就要用到上个进程的返回值，依次类推。而exit是系统调用级别的，它表示了一个**进程**的结束。
- exit函数是退出应用程序，并将应用程序的一个状态返回给OS，这个状态标识了应用程序的一些运行信息。
- 和机器和操作系统有关的一般是： 0为正常退出，非0为非正常退出；
- exit()头文件为`#include <stdlib.h>`